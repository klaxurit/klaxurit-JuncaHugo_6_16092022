{% extends 'base.html.twig' %}

{% block stylesheets %}
	<link rel="stylesheet" href="{{ asset('assets/css/_main.css') }}">
{% endblock %}

{% block title %}Trick
{% endblock %}

{% block body %}


	<div class="modal fade modal-lg" id="videomodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-body">
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					<iframe class="embed-responsive-item" src="" allowfullscreen></iframe>
				</div>
			</div>
		</div>
	</div>


	<div class="modal fade" id="imagemodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-body">
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					<img src="" class="imagepreview" style="width: 100%;">
				</div>
			</div>
		</div>
	</div>

	<div class="container main my-5">
		<div class="text-end">
			<a href="{{ path('app_trick_edit', {'id': trick.id}) }}" class="btn btn-m btn-primary">
				<i class="bi bi-pencil-fill"></i>
			</a>
			{{ include('trick/_delete_form.html.twig') }}
		</div>

		<div class="d-flex flex-column justify-content-center">
			<h1 class="text-center my-5">{{trick.name}}</h1>

			<div id="carousel" class="d-flex justify-content-center">
				{% for media in trick.medias %}
					{% if media.type is same as("Image") %}
						<div class="item">
							<button type="button" class="popImage">
                                <img data-id="{{ media.id }}" class="trick__img" src="{{asset('/uploads/' ~ media.fileName)}}" alt="{{ media.alt }}" title="{{ media.alt }}">
                            </button>
						</div>
					{% else %}
						<div class="item-video">
							<iframe class="trick__video" src="{{ media.url }}" frameborder="0"></iframe>
							<button type="button" class="popVideo"><iframe class="trick__video d-none" src="{{ media.url }}" frameborder="0"></iframe></button>
						</div>
					{% endif %}
				{% endfor %}
			</div>

			<p class="text-justify text-center mt-3">{{trick.description}}</p>

			<div class="trick__groups text-center">
				<span class="badge rounded-pill text-bg-primary">{{trick.trickGroup.name}}</span>
			</div>

			<div class="trick__separator my-3">
				<hr class="rounded">
			</div>

			{% include('trick/_comment.html.twig') %}
		</div>

		<a href="{{ path('app_home') }}" class="btn btn-m btn-secondary">Back to list</a>

	</div>


{% endblock %}


{% block javascripts %}
	<script src="{{ asset('assets/js/slider.js') }}" type="text/javascript"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script>
	$(function () {
        $('.popImage').on('click', function () {
            $('.imagepreview').attr('src', $(this).find('img').attr('src'));
            $('#imagemodal').modal('show');
        });
    });
    $(function () {
        $('.popVideo').on('click', function () {
            $('.embed-responsive-item').attr('src', $(this).find('iframe').attr('src'));
            $('#videomodal').modal('show');
            $("#videomodal").on('hide.bs.modal', function () {
                $(".embed-responsive-item").attr('src', '');
            });
        });
    });
	</script>
{% endblock %}
